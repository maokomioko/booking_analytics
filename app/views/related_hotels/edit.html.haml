.row
  .hidden
    %span(data-message="select_hotels_first")= t('messages.select_hotels_first')
    %span(data-message="confirm_related_bulk_delete")= t('messages.confirm_related_bulk_delete')
    %span(data-message="related_search_prompt")= t('messages.related_search_prompt')
  .col-sm-12{style: 'margin-bottom: 20px'}
    = form_tag related_hotels_path(hotel_id: @hotel.booking_id), method: :post, remote: true, class: 'add-related-form' do
      .col-md-6.no-left-padding
        = hidden_field_tag :id, nil, id: 'add_related_select2', data: { url: related_hotels_search_path(hotel_id: @hotel.booking_id) }
      .col-md-3.no-left-padding
        = submit_tag t('.add_related'), class: 'btn btn-purple'

  .col-sm-12
    - if @related.length > 0
      %table.table.table-hover.table-condensed.related-hotels-table
        %thead
          %tr
            %th= Hotel.human_attribute_name(:booking_id)
            %th= Hotel.human_attribute_name(:name)
            %th= t('.overbooking_partner')
            - if controller_name == 'wizard'
              %th
            %th
        %tbody
          - @related.each do |related_hotel|
            %tr(data-hotel-id="#{ related_hotel.related.booking_id }")
              %td= related_hotel.related.booking_id
              %td
                %strong= related_hotel.related.name
                - if related_hotel.added_manually
                  %span.label.label-default= RelatedHotel.human_attribute_name(:added_manually)
                %br
                %small
                  = related_hotel.related.post_address
              %td
                - if related_hotel.is_overbooking
                  %span.label.label-success= t('overbooking.shared.partner')
                - else
                  â€”
              - if controller_name == 'wizard'
                %td(data-contact-hotel-id="#{ related_hotel.related.booking_id }" data-url="#{ overbooking.hotels_contacts_by_hotel_path }")
                  = render template: 'overbooking/contacts/index', locals: { contacts: related_hotel.related.becomes(Overbooking::Hotel).contacts,
                                                    hotel: related_hotel.related.becomes(Overbooking::Hotel) }
              %td.center
                .visible-md.visible-lg.hidden-sm.hidden-xs
                  = link_to [:related_hotels, :destroy, hotel_id: @hotel.booking_id, id: related_hotel.related.booking_id],
                  class: 'btn btn-xs btn-bricky tooltips remove-related',
                  remote: true, method: :delete,
                  data: { 'original-title' => t('shared.remove')} do
                    = icon('times white')
                .visible-sm.visible-xs.hidden-md.hidden-lg
                  = link_to [:related_hotels, :destroy, hotel_id: @hotel.booking_id, id: related_hotel.related.booking_id],
                  class: 'btn btn-xs btn-bricky remove-related',
                  remote: true, method: :delete do
                    = icon('times white')
